// @noflow

const os = require('os');
const fs = require('fs');
const platform = os.platform();

exports.quarantine = (path, cb) => {
  if (platform === 'win32') {
    const URLZONE_INTERNET = 3;

    fs.writeFile(
      `${path}:Zone.Identifier`,
      `[ZoneTransfer]\r\nZoneId=${URLZONE_INTERNET}\r\n`,
      cb,
    );
  } else {
    const binding = require('bindings')('binding.node');
    binding.quarantine(path, cb);
  }
};
